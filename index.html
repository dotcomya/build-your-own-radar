<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My TechRadar</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tech-radar@latest/dist/tech-radar.css">
</head>
<body>
    <h1>Welcome to My TechRadar</h1>
    <div id="radar"></div>

    <!-- Chargement du script JavaScript pour TechRadar -->
    <script src="https://cdn.jsdelivr.net/npm/tech-radar@latest/dist/tech-radar.js"></script> 

    <script>
        // URL directe vers ton Google Sheet en CSV
        const googleSheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSALvjRecumaooC5rKhyeEpQVI-5MDVMp-39JOh_avGtdODpLsJsImXadKVU_VNAfP6hhjOFnxN8Uku/pub?output=csv';

        // Fonction pour convertir CSV en JSON
        function csvToJSON(csv) {
            const lines = csv.split("\n");
            const result = [];
            const headers = lines[0].split(","); // Premières lignes comme headers

            for (let i = 1; i < lines.length; i++) {
                const obj = {};
                const currentLine = lines[i].split(",");
                
                headers.forEach((header, index) => {
                    obj[header.trim()] = currentLine[index]?.trim() || ""; // Assure-toi d'avoir une valeur valide
                });

                result.push(obj);
            }

            return result;
        }

        // Récupérer et afficher les données du Google Sheet
        fetch(googleSheetUrl)
            .then(response => response.text())
            .then(csvData => {
                console.log('Données CSV récupérées :', csvData); // Affiche les données CSV dans la console

                const jsonData = csvToJSON(csvData); // Convertir en JSON

                // Assurer que les données ont bien été converties
                console.log('Données JSON converties :', jsonData); 

                // Structure des données pour le radar
                const radarData = {
                    sectors: [
                        {
                            name: "Techniques", // Secteur : Techniques
                            technologies: jsonData.map(item => ({
                                name: item.name, // Nom de la technologie
                                category: item.ring,  // Catégorie (ring)
                                description: item.description // Description (HTML inclus)
                            }))
                        }
                    ]
                };

                // Vérifier que les données de radar sont bien formatées
                console.log('Structure du radarData :', radarData);

                // Affichage du radar
                const radar = new TechRadar({ data: radarData });
                radar.render(); // Méthode pour afficher le radar
            })
            .catch(err => {
                console.error('Erreur de récupération des données :', err);
                alert('Erreur de récupération des données, vérifie la console pour plus d\'informations.');
            });
    </script>
</body>
</html>


